- name: Deploy Machine Learning Services
  hosts:
    - machine_learning
  remote_user: root
  gather_facts: true

  tasks:
    - name: Setup basic services and environment
      block:
        - import_role:
            name: docker

    - name: Setup machine learning services
      block:
        - import_role:
            name: nvidia-docker
      when:
        - '"machine_learning" in group_names'

    - name: Configure Telegraf
      block:
        - import_role:
            name: telegraf
        - setup:
